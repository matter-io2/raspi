Debian/Ubuntu packaging notes
======================

Users and permissions
---------------------

We are creating a "conveyor" user to run the conveyor script as. This is set up and handled by the postinst script. The postrm script removes this user.

Any directories that conveyor needs access to are set to it group and user.

Wrapper script
--------------

The conveyor server is called by the /usr/bin/conveyord script. This is a wrapper that runs the virtualenv and then the server.

Debian/Ubuntu installation paths
--------------------------------

We're playing a little fast and loose with the Linux filesystem hierarchy, but to be blunt it's not terribly well-defined anyway.

## Configuration files

Configuration files are stored in /etc. Currently there is one configuration file for conveyor, conveyor.conf.
* /etc/conveyor.conf
** Copied by scons, installed by conveyor.install

## Static libraries

The static library is stored in /usr/lib.
* /usr/lib/libconveyor.a
** Built by scons, installed by conveyor.install

## Header files

The header files are stored in /usr/include.
* /usr/include/conveyor.h
** Copied by scons, installed by conveyor.install

## Conveyor python modules

The Conveyor python module is stored in /usr/share/conveyor/lib.
* /usr/share/conveyor/lib/conveyor/
** Copied by scons, installed by conveyor.install

An argument could be made that this belongs in /usr/lib/conveyor; this was avoided to ensure that we didn't touch too many bits of the filesystem.

## Conveyor virtualenv script

Conveyor does not install its own version of the virtualenv script; instead a depenedency is created on the repository version. This version is run instead.

## Conveyor virtualenv

The virtualenv environment is generated in /usr/share/conveyor.
* /usr/share/conveyor/virtualenv
** Generated by conveyor.postinst

## Wrapper

The binary wrapper, conveyor, is installed in /usr/bin.
* /usr/bin/conveyor
** //TODO// - does not exist

## Log files

Log files are kept in /usr/log/conveyor, a directory owned by the conveyor user.
* /var/log/conveyor
** Created and chowned by postinst script, cleaned up by postrm script

## Upstart files

The Upstart script is located in data/conveyor.conf.
* /etc/init/conveyor.conf
This file is installed by conveyor.install.

## Lock files

Lock files are created in the /var/run/conveyor directory by conveyor itself. This directory is owned by the conveyor user.
* /var/run/conveyor
** Created by postinst


